<?xml version="1.0" encoding="utf-8"?>
<ContentPage
  xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
  xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
  x:Class="SUS.EOS.NeoWallet.Pages.MainPage"
  Title="Wallet"
  BackgroundColor="{DynamicResource PageBackgroundColor}"
>
  <Grid ColumnDefinitions="Auto,*">
    <!-- Sidebar Navigation -->
    <Border 
      Grid.Column="0"
      BackgroundColor="{DynamicResource Card}"
      StrokeThickness="0"
      WidthRequest="220"
      Padding="0"
    >
      <Grid RowDefinitions="Auto,*,Auto">
        <!-- Logo & App Title -->
        <VerticalStackLayout Grid.Row="0" Padding="16,20" Spacing="8">
          <Border 
            BackgroundColor="{DynamicResource Primary}"
            StrokeShape="RoundRectangle 12"
            StrokeThickness="0"
            WidthRequest="48"
            HeightRequest="48"
            HorizontalOptions="Start"
          >
            <Label Text="âš¡" FontSize="24" HorizontalOptions="Center" VerticalOptions="Center" TextColor="White" />
          </Border>
          <Label Text="Antelope Wallet" FontSize="18" FontAttributes="Bold" TextColor="{DynamicResource TextPrimary}" />
          
          <!-- Chain Selector -->
          <Border 
            BackgroundColor="{DynamicResource Surface}"
            StrokeShape="RoundRectangle 8"
            StrokeThickness="0"
            Padding="10,8"
            Margin="0,8,0,0"
          >
            <Border.GestureRecognizers>
              <TapGestureRecognizer Tapped="OnChainSelectorClicked" />
            </Border.GestureRecognizers>
            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="8">
              <Border Grid.Column="0" BackgroundColor="{DynamicResource WaxColor}" StrokeShape="RoundRectangle 10" StrokeThickness="0" WidthRequest="20" HeightRequest="20" HorizontalOptions="Center" VerticalOptions="Center">
                <Label x:Name="ChainIconLabel" Text="W" FontSize="10" FontAttributes="Bold" TextColor="White" HorizontalOptions="Center" VerticalOptions="Center" />
              </Border>
              <Label Grid.Column="1" x:Name="ChainNameLabel" Text="WAX Mainnet" FontSize="12" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
              <Label Grid.Column="2" Text="â–¼" FontSize="10" TextColor="{DynamicResource TextSecondary}" VerticalOptions="Center" />
            </Grid>
          </Border>
          
          <!-- Account Selector (below chain selector) -->
          <Border 
            BackgroundColor="{DynamicResource Surface}"
            StrokeShape="RoundRectangle 8"
            StrokeThickness="0"
            Padding="10,8"
            Margin="0,4,0,0"
          >
            <Border.GestureRecognizers>
              <TapGestureRecognizer Tapped="OnAccountSelectorClicked" />
            </Border.GestureRecognizers>
            <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="8">
              <Border Grid.Column="0" BackgroundColor="{DynamicResource Primary}" StrokeShape="RoundRectangle 10" StrokeThickness="0" WidthRequest="20" HeightRequest="20" HorizontalOptions="Center" VerticalOptions="Center">
                <Label x:Name="AccountIconLabel" Text="ðŸ‘¤" FontSize="10" TextColor="White" HorizontalOptions="Center" VerticalOptions="Center" />
              </Border>
              <VerticalStackLayout Grid.Column="1" Spacing="0" VerticalOptions="Center">
                <Label x:Name="AccountNameLabel" Text="No Account" FontSize="12" TextColor="{DynamicResource TextPrimary}" LineBreakMode="TailTruncation" />
                <Label x:Name="AccountPermissionLabel" Text="Select account" FontSize="10" TextColor="{DynamicResource TextSecondary}" />
              </VerticalStackLayout>
              <Label Grid.Column="2" Text="â–¼" FontSize="10" TextColor="{DynamicResource TextSecondary}" VerticalOptions="Center" />
            </Grid>
          </Border>
        </VerticalStackLayout>
        
        <!-- Navigation Menu -->
        <ScrollView Grid.Row="1" Padding="8,0">
          <VerticalStackLayout Spacing="4">
            <!-- Section: Wallet -->
            <Label Text="WALLET" FontSize="10" FontAttributes="Bold" TextColor="{DynamicResource TextSecondary}" Margin="12,16,0,8" />
            
            <Border x:Name="NavHome" BackgroundColor="{DynamicResource Primary}" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,10">
              <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnNavHomeClicked" />
              </Border.GestureRecognizers>
              <HorizontalStackLayout Spacing="12">
                <Label Text="ðŸ " FontSize="16" />
                <Label Text="Home" FontSize="14" TextColor="White" FontAttributes="Bold" VerticalOptions="Center" />
              </HorizontalStackLayout>
            </Border>
            
            <Border x:Name="NavDashboard" BackgroundColor="Transparent" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,10">
              <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnDashboardClicked" />
              </Border.GestureRecognizers>
              <HorizontalStackLayout Spacing="12">
                <Label Text="ðŸ“Š" FontSize="16" />
                <Label Text="Dashboard" FontSize="14" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
              </HorizontalStackLayout>
            </Border>
            
            <Border x:Name="NavSend" BackgroundColor="Transparent" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,10">
              <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnSendClicked" />
              </Border.GestureRecognizers>
              <HorizontalStackLayout Spacing="12">
                <Label Text="ðŸ“¤" FontSize="16" />
                <Label Text="Send" FontSize="14" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
              </HorizontalStackLayout>
            </Border>
            
            <Border x:Name="NavReceive" BackgroundColor="Transparent" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,10">
              <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnReceiveClicked" />
              </Border.GestureRecognizers>
              <HorizontalStackLayout Spacing="12">
                <Label Text="ðŸ“¥" FontSize="16" />
                <Label Text="Receive" FontSize="14" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
              </HorizontalStackLayout>
            </Border>
            
            <!-- Section: Contracts -->
            <Label Text="CONTRACTS" FontSize="10" FontAttributes="Bold" TextColor="{DynamicResource TextSecondary}" Margin="12,16,0,8" />
            
            <Border x:Name="NavActions" BackgroundColor="Transparent" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,10">
              <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnContractActionsClicked" />
              </Border.GestureRecognizers>
              <HorizontalStackLayout Spacing="12">
                <Label Text="âš¡" FontSize="16" />
                <Label Text="Actions" FontSize="14" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
              </HorizontalStackLayout>
            </Border>
            
            <Border x:Name="NavTables" BackgroundColor="Transparent" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,10">
              <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnContractTablesClicked" />
              </Border.GestureRecognizers>
              <HorizontalStackLayout Spacing="12">
                <Label Text="ðŸ“‹" FontSize="16" />
                <Label Text="Tables" FontSize="14" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
              </HorizontalStackLayout>
            </Border>
            
            <!-- Section: Account -->
            <Label Text="ACCOUNT" FontSize="10" FontAttributes="Bold" TextColor="{DynamicResource TextSecondary}" Margin="12,16,0,8" />
            
            <Border x:Name="NavImport" BackgroundColor="Transparent" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,10">
              <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnImportWalletClicked" />
              </Border.GestureRecognizers>
              <HorizontalStackLayout Spacing="12">
                <Label Text="ðŸ“" FontSize="16" />
                <Label Text="Import Keys" FontSize="14" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
              </HorizontalStackLayout>
            </Border>
            
            <Border x:Name="NavCreate" BackgroundColor="Transparent" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,10">
              <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnCreateAccountClicked" />
              </Border.GestureRecognizers>
              <HorizontalStackLayout Spacing="12">
                <Label Text="âž•" FontSize="16" />
                <Label Text="Create Account" FontSize="14" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
              </HorizontalStackLayout>
            </Border>
          </VerticalStackLayout>
        </ScrollView>
        
        <!-- Bottom: Settings -->
        <VerticalStackLayout Grid.Row="2" Padding="8,8,8,16" Spacing="4">
          <BoxView HeightRequest="1" Color="{DynamicResource Border}" Margin="4,0,4,8" />
          <Border x:Name="NavSettings" BackgroundColor="Transparent" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,10">
            <Border.GestureRecognizers>
              <TapGestureRecognizer Tapped="OnSettingsClicked" />
            </Border.GestureRecognizers>
            <HorizontalStackLayout Spacing="12">
              <Label Text="âš™ï¸" FontSize="16" />
              <Label Text="Settings" FontSize="14" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
            </HorizontalStackLayout>
          </Border>
        </VerticalStackLayout>
      </Grid>
    </Border>
    
    <!-- Main Content Area -->
    <ScrollView Grid.Column="1" BackgroundColor="{DynamicResource PageBackgroundColor}">
      <VerticalStackLayout Spacing="24" Padding="32" MaximumWidthRequest="800" HorizontalOptions="Center">
        
        <!-- Wallet Header Card -->
        <Border
          BackgroundColor="{DynamicResource Primary}"
          StrokeThickness="0"
          StrokeShape="RoundRectangle 16"
          Padding="24"
        >
          <Grid RowDefinitions="Auto,Auto,Auto" RowSpacing="12">
            <Label
              Grid.Row="0"
              x:Name="BalanceLabel"
              Text="$0.00 USD"
              FontSize="36"
              FontAttributes="Bold"
              TextColor="White"
            />
            <Border Grid.Row="1" BackgroundColor="White" Opacity="0.2" StrokeShape="RoundRectangle 8" StrokeThickness="0" Padding="12,8">
              <Label
                x:Name="AddressLabel"
                Text="No wallet loaded"
                FontSize="13"
                TextColor="White"
                FontFamily="Consolas"
              />
            </Border>
          </Grid>
        </Border>
        
        <!-- Quick Actions Row -->
        <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="16">
          <Border Grid.Column="0" BackgroundColor="{DynamicResource Card}" StrokeShape="RoundRectangle 12" Stroke="{DynamicResource Border}" StrokeThickness="1" Padding="16">
            <Border.GestureRecognizers>
              <TapGestureRecognizer Tapped="OnSendClicked" />
            </Border.GestureRecognizers>
            <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
              <Border BackgroundColor="{DynamicResource Primary}" StrokeShape="RoundRectangle 20" StrokeThickness="0" WidthRequest="40" HeightRequest="40" HorizontalOptions="Center">
                <Label Text="â†‘" FontSize="20" FontAttributes="Bold" TextColor="White" HorizontalOptions="Center" VerticalOptions="Center" />
              </Border>
              <Label Text="Send" FontSize="13" TextColor="{DynamicResource TextPrimary}" HorizontalTextAlignment="Center" />
            </VerticalStackLayout>
          </Border>
          
          <Border Grid.Column="1" BackgroundColor="{DynamicResource Card}" StrokeShape="RoundRectangle 12" Stroke="{DynamicResource Border}" StrokeThickness="1" Padding="16">
            <Border.GestureRecognizers>
              <TapGestureRecognizer Tapped="OnReceiveClicked" />
            </Border.GestureRecognizers>
            <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
              <Border BackgroundColor="{DynamicResource Secondary}" StrokeShape="RoundRectangle 20" StrokeThickness="0" WidthRequest="40" HeightRequest="40" HorizontalOptions="Center">
                <Label Text="â†“" FontSize="20" FontAttributes="Bold" TextColor="White" HorizontalOptions="Center" VerticalOptions="Center" />
              </Border>
              <Label Text="Receive" FontSize="13" TextColor="{DynamicResource TextPrimary}" HorizontalTextAlignment="Center" />
            </VerticalStackLayout>
          </Border>
          
          <Border Grid.Column="2" BackgroundColor="{DynamicResource Card}" StrokeShape="RoundRectangle 12" Stroke="{DynamicResource Border}" StrokeThickness="1" Padding="16">
            <Border.GestureRecognizers>
              <TapGestureRecognizer Tapped="OnContractActionsClicked" />
            </Border.GestureRecognizers>
            <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
              <Border BackgroundColor="{DynamicResource Tertiary}" StrokeShape="RoundRectangle 20" StrokeThickness="0" WidthRequest="40" HeightRequest="40" HorizontalOptions="Center">
                <Label Text="âš¡" FontSize="18" TextColor="White" HorizontalOptions="Center" VerticalOptions="Center" />
              </Border>
              <Label Text="Actions" FontSize="13" TextColor="{DynamicResource TextPrimary}" HorizontalTextAlignment="Center" />
            </VerticalStackLayout>
          </Border>
          
          <Border Grid.Column="3" BackgroundColor="{DynamicResource Card}" StrokeShape="RoundRectangle 12" Stroke="{DynamicResource Border}" StrokeThickness="1" Padding="16">
            <Border.GestureRecognizers>
              <TapGestureRecognizer Tapped="OnImportWalletClicked" />
            </Border.GestureRecognizers>
            <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
              <Border BackgroundColor="{DynamicResource Gray500}" StrokeShape="RoundRectangle 20" StrokeThickness="0" WidthRequest="40" HeightRequest="40" HorizontalOptions="Center">
                <Label Text="+" FontSize="20" FontAttributes="Bold" TextColor="White" HorizontalOptions="Center" VerticalOptions="Center" />
              </Border>
              <Label Text="Import" FontSize="13" TextColor="{DynamicResource TextPrimary}" HorizontalTextAlignment="Center" />
            </VerticalStackLayout>
          </Border>
        </Grid>
        
        <!-- Assets Section -->
        <VerticalStackLayout Spacing="12">
          <Label Text="Assets" FontSize="20" FontAttributes="Bold" TextColor="{DynamicResource TextPrimary}" />
          <Border BackgroundColor="{DynamicResource Card}" StrokeShape="RoundRectangle 12" Stroke="{DynamicResource Border}" StrokeThickness="1" Padding="0">
            <CollectionView x:Name="AssetsCollectionView" SelectionMode="None">
              <CollectionView.EmptyView>
                <VerticalStackLayout Padding="24" Spacing="8" HorizontalOptions="Center">
                  <Label Text="ðŸ’°" FontSize="32" HorizontalOptions="Center" />
                  <Label Text="No assets found" FontSize="14" TextColor="{DynamicResource TextSecondary}" HorizontalTextAlignment="Center" />
                  <Label Text="Import a key to view your balances" FontSize="12" TextColor="{DynamicResource TextSecondary}" HorizontalTextAlignment="Center" />
                </VerticalStackLayout>
              </CollectionView.EmptyView>
              <CollectionView.ItemTemplate>
                <DataTemplate>
                  <Grid Padding="16" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                    <Border Grid.Column="0" BackgroundColor="{DynamicResource Surface}" StrokeShape="RoundRectangle 20" StrokeThickness="0" WidthRequest="40" HeightRequest="40" HorizontalOptions="Center" VerticalOptions="Center">
                      <Label Text="ðŸ’Ž" FontSize="18" HorizontalOptions="Center" VerticalOptions="Center" />
                    </Border>
                    <VerticalStackLayout Grid.Column="1" Spacing="2" VerticalOptions="Center">
                      <Label Text="{Binding Symbol}" FontSize="15" FontAttributes="Bold" TextColor="{DynamicResource TextPrimary}" />
                      <Label Text="{Binding Symbol}" FontSize="12" TextColor="{DynamicResource TextSecondary}" />
                    </VerticalStackLayout>
                    <Label Grid.Column="2" Text="{Binding Amount, StringFormat='{0:N4}'}" FontSize="15" FontAttributes="Bold" TextColor="{DynamicResource TextPrimary}" VerticalOptions="Center" />
                  </Grid>
                </DataTemplate>
              </CollectionView.ItemTemplate>
            </CollectionView>
          </Border>
        </VerticalStackLayout>
        
        <!-- Recent Transactions Section -->
        <VerticalStackLayout Spacing="12">
          <Grid ColumnDefinitions="*,Auto">
            <Label Grid.Column="0" Text="Recent Transactions" FontSize="20" FontAttributes="Bold" TextColor="{DynamicResource TextPrimary}" />
            <Border Grid.Column="1" BackgroundColor="Transparent" Padding="8,4">
              <Border.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnViewAllTransactionsClicked" />
              </Border.GestureRecognizers>
              <Label Text="View All â†’" FontSize="13" TextColor="{DynamicResource Primary}" VerticalOptions="Center" />
            </Border>
          </Grid>
          <Border BackgroundColor="{DynamicResource Card}" StrokeShape="RoundRectangle 12" Stroke="{DynamicResource Border}" StrokeThickness="1" Padding="0">
            <CollectionView x:Name="RecentTransactionsCollectionView" SelectionMode="None">
              <CollectionView.EmptyView>
                <VerticalStackLayout Padding="24" Spacing="8" HorizontalOptions="Center">
                  <Label Text="ðŸ“œ" FontSize="32" HorizontalOptions="Center" />
                  <Label Text="No transactions yet" FontSize="14" TextColor="{DynamicResource TextSecondary}" HorizontalTextAlignment="Center" />
                </VerticalStackLayout>
              </CollectionView.EmptyView>
              <CollectionView.ItemTemplate>
                <DataTemplate>
                  <Grid Padding="16" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12" RowDefinitions="Auto,Auto" RowSpacing="4">
                    <Border Grid.Column="0" Grid.RowSpan="2" BackgroundColor="{DynamicResource Surface}" StrokeShape="RoundRectangle 20" StrokeThickness="0" WidthRequest="40" HeightRequest="40" HorizontalOptions="Center" VerticalOptions="Center">
                      <Label Text="â†”" FontSize="18" HorizontalOptions="Center" VerticalOptions="Center" />
                    </Border>
                    <Label Grid.Row="0" Grid.Column="1" FontSize="14" FontAttributes="Bold" TextColor="{DynamicResource TextPrimary}">
                      <Label.Text>
                        <MultiBinding StringFormat="{}{0} â†’ {1}">
                          <Binding Path="From" />
                          <Binding Path="To" />
                        </MultiBinding>
                      </Label.Text>
                    </Label>
                    <Label Grid.Row="1" Grid.Column="1" Text="{Binding Timestamp, StringFormat='{0:MMM dd, yyyy HH:mm}'}" FontSize="12" TextColor="{DynamicResource TextSecondary}" />
                    <VerticalStackLayout Grid.Row="0" Grid.Column="2" Grid.RowSpan="2" Spacing="2" VerticalOptions="Center">
                      <Label Text="{Binding Amount}" FontSize="14" FontAttributes="Bold" TextColor="{DynamicResource TextPrimary}" HorizontalOptions="End" />
                      <Label Text="{Binding Status}" FontSize="10" TextColor="{DynamicResource Success}" HorizontalOptions="End" />
                    </VerticalStackLayout>
                  </Grid>
                </DataTemplate>
              </CollectionView.ItemTemplate>
            </CollectionView>
          </Border>
        </VerticalStackLayout>
        
        <!-- Footer -->
        <Label Text="ðŸ” Your wallet is secured with local encryption" FontSize="12" TextColor="{DynamicResource TextSecondary}" HorizontalOptions="Center" Margin="0,16,0,0" />
        
      </VerticalStackLayout>
    </ScrollView>
  </Grid>
</ContentPage>
